\documentclass[a4paper,11pt]{report}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{lmodern}
\usepackage{titlesec}
\usepackage{exptech}
\usepackage{listings}
\usepackage{hyperref}
\usepackage{color}
% Configuration pour le code
\include{./lst_config}

% Pour les figures
\usepackage[usenames,dvipsnames]{pstricks}
\usepackage{epsfig}

\usepackage{tikz}

%% ** Begin document ** %%

\title{Étude pratique : Amélioration de la complétion automatique de \LaTeX{}ila}
\author{Axel Caro\and François Bochet\and Maximilien Richer}
\date{2014-2015}

\begin{document}

\maketitle %affichage du titre
\tableofcontents %table des matières

\section{Remerciements} % (fold)
\label{sec:remerciements}
Nous remercions Arnaud Blouin, notre encadrant, pour sa disponibilité et ses conseils, ainsi que Sébastien Wilmet, développeur et mainteneur de LaTeXila.

\chapter{Introduction}
\label{cha:Introduction}
Les \textit{études pratiques} sont des projets réalisé chaque année pas les élèves du département Informatique de l'INSA de Rennes. Ils s'étalent sur toute la durée de l'année scolaire et visent à permettre aux étudiants de développer leur sens du travail et équipe et leur autonomie. Les sujets sont aussi divers que variés, allant de prototypes applicatifs au site web, en passant par les réalisations d'IA.

Cette étude pratique en particulier se présente sous la forme d'une contribution à un logiciel dont le code source est ouvert\footnote{Logiciel dit "open-source"}, c'est à dire qu'il est mis à disposition du public pour modification.

\section{Latexila}
\label{sec:latexila}
Latexila est un projet d'éditeur LaTeX pour le projet Gnome, dont le développement a commencé en 2009 à l'initiative de Sébastien Wilmet, qui est encore à ce jour le mainteneur du projet. Bien que commencé en C, le projet a été porté vers le langage Vala en 2010. LaTeXiLa adopte une approche centré sur le code, ce qui lui permet d'être bien plus léger que nombre d'autres éditeurs, comme TeXMaker\footnote{\url{http://www.xm1math.net/texmaker/index_fr.html}} par exemple. De par cette philosophie, il ne possède pas de module WYSIWYG\footnote{What You See Is What You Get - Un mode d'édition ou l'utilisateur édite directement une vue correspondant au rendu final}.

%\include{./draw/UI}

%see more @https://wiki.gnome.org/Apps/LaTeXila/History

\subsection{À propos de \LaTeX}
LaTeX est un langage utilisé pour la composition de documents. Il permet notamment de mettre en place des feuilles de style normalisées ou encore de construire des expressions mathématiques.
% write something here ?

\subsection{Le langage Vala}
\label{sub:vala}
Vala est un langage développé pour le projet Gnome. Il vise à être une alternative au C\# et au Java en proposant une syntaxe puissante pour la programation orientée objet.
Il se base sur la librairie GObject et est compilé en C via la commande `valac`.
% more @ https://wiki.gnome.org/Projects/Vala/About
\begin{lstlisting} % TODO encadrer

void main () {
    print ("hello, world\n");
}

\end{lstlisting}\textit{Exemple tiré de wiki.gnome.org/Projects/Vala/BasicSample}

\section{Compiler LaTeXila}
\label{cha:compiler}
La compilation d'un projet GNOME est un processus complexe pour un non-initié. L'obtention de paquets en pré-série souvent non stables est déconseillée pour les non-développeurs du fait de leur stabilité toute relative. On utilise donc des outils spécifiques de manière à séparer environnement utilisateur et environnement de test. 

\subsection{Jhbuild}
\label{sub:jhbuild}

\begin{quote}
JHBuild allows you to build and run Gnome platform and applications building the required modules in a sandbox environment, isolating the installation; so there is no need to build and run Gnome inside a virtual machine. \textit{\url{wiki.gnome.org}}
\end{quote}

Comme indiqué ci-dessus, il s'agit d'un outil conçu pour permettre au développeur de construire les librairies d'un projet dans un environnement bac-à-sable, de manière à éviter une instabilité de la machine de développement causée par l'utilisation de librairies en pré-version. Il fournit certaines commandes très utiles, telles que :

\begin{description}
  \item[jhbuild update <package>] Met à jour le paquet et toute ses dépendances
  \item[jhbuild build <package>] Met à jour et compile le paquet et toute ses dépendances
  \item[jhbuild buildone <package>] Ne compile que le paquet ciblé
  \item[jhbuild make <target>] Exécute le Makefile à l'emplacement courant
\end{description}

Ainsi, un \textit{jhbuild build latexila} réalise, pour chaque dépendances de latexila :

\begin{description} 
  \item[Mise à jour] Un \textit{checkout} sur la branche master du dépôt, suivi d'un \textit{fetch} puis d'un \textit{rebase} 
  \item[Compilation] Exécution du \textit{make all}
\end{description}

Dans le cas de la compilation d'une version de test, on utilisera \textit{jhbuild make}, qui nous permettra de compiler sur la branche courante.
% à développer

\chapter{Étude pratique} % (fold)
\label{cha:etude_pratique}
Le but de cette étude pratique est d'ajouter à la complétion le support de la commande \textbf{\\ref} qui proposerait comme complétion une liste des clef des \\label. 

\section{Tâche à réaliser} % (fold)
\label{sec:tache_a_realiser}
La tâche à réaliser est l'amélioration de la complétion des commande de références. Il existe un système déjà en place, celui-ci doit donc être amélioré.

\subsection{La complétion dans LaTeXila 2.2}
\label{sub:completion}
La version 2.2 de LaTeXiLa fournit une complétion exhaustive des éléments statiques du langage \LaTeX  en se basant sur un fichier XML descriptif lu au démarrage du programme.
Cette complétion est donc dite \textit{statique}, car elle ne s'adapte pas au contenu précédemment tapé par l'utilisateur\ref{cha:compiler}. 

\begin{description}
  \item[Fonction] de la forme \\\textit{fonction}\{argument\}, défini par \LaTeX
  \item[Argument] peut être définit par \LaTeX  ou tiré de l'environnement utilisateur
\end{description}

\subsection{Une complétion dynamique}
\label{sub:completion_dyn}

% section tâche_à_réaliser (end)

\section{Gestion de projet} % (fold)

\subsection{Git}
\label{sub:git}
Git est le VCS\footnote{Version Control System} utilisé par la très grande majorité des projets open-source. LaTeXiLa est hébergé sur le dépôt du projet Gnome\footnote{\url{git.gnome.org}}, un miroir est également disponible sur Github % adresse 
Pour ce projet, nous avons créé un \textit{fork} du dépôt principal sur Github et travaillé sur une branche annexe, régulièrement mise à jour à partir du dépôt pricipale.

\subsection{Bugzilla}
Les soumissions sont faites via le bugzilla du projet Gnome, ce qui permet au mainteneur de commenter le code soumis.
Il s'ensuit ensuite un va-et-vient entre le mainteneur et le développeur jusqu'à la fusion du patch dans la branche principale du projet.

\chapter{Réalisation}
La réalisation s'est faite par petits pas. Sur une base de deux semaines de travail, l'équipe se donnait un objectif à atteindre pour le point suivant avec l'encadrant.
Ces points bi-mensuels permettaient de discuter des directions à prendre pour le développement.

\section{Intégration d'une recherche au document courant}
Pour commencer, nous avons utilisé un parseur existant, celui permettant de construire l'arbre représentatif de la structure des documents.

%\include{./draw/flow_parser_call}

Ces résultats sont ensuite intégré au \textit{Completion Provider}.

\subsection{Invite de complétion}

\lstset{language=C}
\begin{lstlisting}[frame=single]
public class CompletionProvider : GLib.Object, SourceCompletionProvider
{
    struct CompletionCommand
    {
        string name;
        string? package;
        CompletionArgument[] args;
    }

    struct CompletionArgument
    {
        string label;
        bool optional;
        CompletionChoice[] choices;
    }

    public struct CompletionChoice
    {
        string name;
        string? package;
        string? insert;
        string? insert_after;
    }
\end{lstlisting}

\section{Intégration d'une recherche à plusieurs documents}

L'étape suivante a été l'intégration de 

\section{Intégration des fichiers non-ouverts}

\chapter{Conclusion}
Cette étude pratique a été pour nous l'occasion de découvrir le fonctionnement des projets open-source.

\end{document}
